<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.doit.ik.mapper.ProjectMapper">

	<!--  상세보기용 프로젝트 조회  -->
	<select id="getProject" resultType="org.doit.ik.domain.Project">
		<![CDATA[
			SELECT *
			FROM project
			WHERE pro_cd = #{pro_cd}
		]]>
	</select>

	<!--  세부 카테고리 객체 얻어오기 -->	
	<select id="getDetailCategory" resultType="org.doit.ik.domain.DetailCategory">
		<![CDATA[
			SELECT d.* 
			FROM PROJECT p JOIN DTL_CTG d ON p.dtl_ctg_code = d.dtl_ctg_code 
			WHERE PRO_CD = #{pro_cd}
		]]>
	</select>	
	
	<!--  대표 이미지 파일 얻어오기  -->
	<select id="getImageFiles" resultType="org.doit.ik.domain.File">
		<![CDATA[
			SELECT * 
			FROM ATT_FILE 
			WHERE  PRO_CD = #{pro_cd}
		]]>
	</select>

	<!-- 달성금액 가져오기 -->
	<select id="getPaySum" resultType="Integer">
		<![CDATA[
			SELECT NVL(SUM(sp_total),0)
			FROM SP_PAY 
			WHERE pro_cd = #{pro_cd}
		]]>
	</select>
	
	<select id="getProjectPlan" resultType="org.doit.ik.domain.Plan">
		<![CDATA[
			SELECT * 
			FROM PROJECT_PLAN 
			WHERE pro_cd = #{pro_cd} 
		]]>
	</select>
	
	<select id="getPolicy" resultType="org.doit.ik.domain.Policy">
		<![CDATA[
			SELECT * 
			FROM TAS 
			WHERE pro_cd = #{pro_cd}
		]]>
	</select>
	
	
	<select id="getMember" resultType="org.doit.ik.domain.Member">
		<![CDATA[
			SELECT * 
			FROM MEMBER 
			WHERE m_cd = #{m_cd}
		]]>
	</select>
	
	
	<select id="getCreatorPhoto" resultType="org.doit.ik.domain.File">
		<![CDATA[
			SELECT * 
			FROM ATT_FILE 
			WHERE m_cd = #{m_cd} 
		]]>
	</select>
	
	<select id="selectGiftList" resultType="org.doit.ik.domain.Gift">
		<![CDATA[
			SELECT * 
			FROM GIFT 
			WHERE pro_cd = #{pro_cd}
		]]>
	</select>
	
	<select id="getBuyAmount" resultType="Integer">
		<![CDATA[
			SELECT NVL(Count(*),0)
			FROM SP_PAY 
			WHERE gift_cd = #{gift_cd} 
		]]>
	</select>
	
	<select id="getItems" resultType="org.doit.ik.domain.ItemSet">
		<![CDATA[
			SELECT item_set_cd, item_cnt, gift_cd, s.item_cd, item_name 
			FROM item_set s 
			LEFT JOIN item i ON s.item_cd = i.item_cd 
			WHERE gift_cd = #{gift_cd} 
		]]>
	</select>
	
	
	
</mapper>
